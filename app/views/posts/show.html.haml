.container
  .card
    .post
      .post-header
        .avatar-img
          = image_tag @post.user.avatar
        .post-info
          .post-user
            = @post.user.account
          .post-ago
            = "#{time_ago_in_words(@post.created_at)} ago"
      .post-content
        .content-images
          - case @post.images.size
          - when 1
            .row
              .col
                = image_tag(@post.images[0].variant(resize_to_fill: [600, 600]), class: "img-fluid", data: { bs_toggle: "modal", bs_target: "#imageModal-#{@post.id}-0" })
                = render "modal", image: post.images[0], index: 0, post_id: @post.id

          - when 2
            .row.g-1
              - @post.images.each_with_index do |image, index|
                .col-6
                  = image_tag(image.variant(resize_to_fill: [150, 300]), class: "img-fluid", data: { bs_toggle: "modal", bs_target: "#imageModal-#{@post.id}-#{index}" })
                  = render "modal", image: image, index: index, post_id: @post.id

          - when 3
            .row.g-1
              .col-md-8
                = image_tag(@post.images[0].variant(resize_to_fill: [400, 600]), class: "img-fluid", data: { bs_toggle: "modal", bs_target: "#imageModal-#{@post.id}-0" })
                = render "modal", image: @post.images[0], index: 0, post_id: @post.id
              .col-md-4
                .row.g-0
                  - @post.images[1..2].each_with_index do |image, i|
                    .col-12.mb-1
                      = image_tag(image.variant(resize_to_fill: [200, 301]), class: "img-fluid", data: { bs_toggle: "modal", bs_target: "#imageModal-#{@post.id}-#{i + 1}" })
                      = render "modal", image: image, index: i + 1, post_id: @post.id

          - when 4
            .row.g-1
              .col-md-8
                = image_tag(@post.images[0].variant(resize_to_fill: [400, 600]), class: "img-fluid", data: { bs_toggle: "modal", bs_target: "#imageModal-#{@post.id}-0" })
                = render "modal", image: @post.images[0], index: 0, post_id: @post.id
              .col-md-4
                .row
                  - post.images[1..3].each_with_index do |image, i|
                    .col-12.mb-1
                      = image_tag(image.variant(resize_to_fill: [200, 199]), class: "img-fluid", data: { bs_toggle: "modal", bs_target: "#imageModal-#{@post.id}-#{i + 1}" })
                      = render "modal", image: image, index: i + 1, post_id: @post.id

          - when 5
            .row.g-1
              .col-md-6
                = image_tag(@post.images[0].variant(resize_to_fill: [300, 600]), class: "img-fluid", data: { bs_toggle: "modal", bs_target: "#imageModal-#{@post.id}-0" })
                = render "modal", image: @post.images[0], index: 0, post_id: @post.id
              .col-md-6
                .row.g-1
                  - @post.images[1..2].each_with_index do |image, i|
                    .col-6.mb-1
                      = image_tag(image.variant(resize_to_fill: [150, 303]), class: "img-fluid", data: { bs_toggle: "modal", bs_target: "#imageModal-#{@post.id}-#{i + 1}" })
                      = render "modal", image: image, index: i + 1, post_id: @post.id
                .row.g-1
                  - @post.images[3..4].each_with_index do |image, i|
                    .col-6.mb-1
                      = image_tag(image.variant(resize_to_fill: [150, 303]), class: "img-fluid", data: { bs_toggle: "modal", bs_target: "#imageModal-#{@post.id}-#{i + 3}" })
                      = render "modal", image: image, index: i + 3, post_id: @post.id

          - when 6
            .row.g-1.mb-1
              .col-md-6
                = image_tag(@post.images[0].variant(resize_to_fill: [300, 400]), class: "img-fluid", data: { bs_toggle: "modal", bs_target: "#imageModal-#{@post.id}-0" })
                = render "modal", image: @post.images[0], index: 0, post_id: @post.id
              .col-md-6
                = image_tag(@post.images[1].variant(resize_to_fill: [300, 400]), class: "img-fluid", data: { bs_toggle: "modal", bs_target: "#imageModal-#{@post.id}-1" })
                = render "modal", image: @post.images[1], index: 1, post_id: @post.id
            .row.g-1
              .col-md-12
                .row.g-1
                  - @post.images[2..5].each_with_index do |image, i|
                    .col-3.mb-1
                      = image_tag(image.variant(resize_to_fill: [150, 200]), class: "img-fluid", data: { bs_toggle: "modal", bs_target: "#imageModal-#{@post.id}-#{i + 2}" })
                      = render "modal", image: image, index: i + 2, post_id: @post.id

          - when 7
            .row.g-1.mb-1
              .col-md-9
                = image_tag(@post.images[0].variant(resize_to_fill: [450, 450]), class: "img-fluid", data: { bs_toggle: "modal", bs_target: "#imageModal-#{@post.id}-0" })
                = render "modal", image: @post.images[0], index: 0, post_id: @post.id
              .col-md-3
                - @post.images[1..2].each_with_index do |image, i|
                  .col-12.mb-1
                    = image_tag(image.variant(resize_to_fill: [150, 228]), class: "img-fluid", data: { bs_toggle: "modal", bs_target: "#imageModal-#{@post.id}-#{i + 1}" })
                    = render "modal", image: image, index: i + 1, post_id: @post.id
            .row.g-1
              .col-md-12
                .row.g-1
                  - @post.images[3..6].each_with_index do |image, i|
                    .col-3.mb-1
                      = image_tag(image.variant(resize_to_fill: [150, 200]), class: "img-fluid", data: { bs_toggle: "modal", bs_target: "#imageModal-#{@post.id}-#{i + 3}" })
                      = render "modal", image: image, index: i + 3, post_id: @post.id

          - when 8
            .row.g-1
              .col-md-6
                = image_tag(@post.images[0].variant(resize_to_fill: [300, 600]), class: "img-fluid", data: { bs_toggle: "modal", bs_target: "#imageModal-#{@post.id}-0" })
                = render "modal", image: @post.images[0], index: 0, post_id: @post.id
              .col-md-6
                .row.g-1
                  - @post.images[1..7].each_with_index do |image, i|
                    .col-12
                      = image_tag(image.variant(resize_to_fill: [300, 81]), class: "img-fluid", data: { bs_toggle: "modal", bs_target: "#imageModal-#{@post.id}-#{i + 1}" })
                      = render "modal", image: image, index: i + 1, post_id: @post.id

      .post-footer
        .group
          - if user_signed_in?
            .sign
              - if current_user.has_liked?(@post)
                = link_to post_like_path(@post), data: { method: 'delete' } do
                  = image_tag 'heart-full.svg'
              - else
                = link_to post_like_path(@post), data: { method: 'post'} do
                  = image_tag 'heart-blank.svg'
          .sign
            = image_tag 'comment.svg'
          .sign
            = link_to "https://twitter.com/share?url=#{CGI.escape(@post.url)}&text=#{CGI.escape("【テスト】\n\n#{@post.caption}")}", target: "_blank", rel: "noopener" do
              = image_tag 'link.svg'
        .post-like
          = @post.like_display
        .caption
          .caption-user
            = @post.user.account
          .caption-content
            = @post.caption
